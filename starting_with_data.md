Question 1: Which cities and countries have the highest level of transaction revenues on the site?

SQL Queries:

SELECT
    city,
    country,
    SUM(transactionRevenue) AS total_transaction_revenue
FROM
    all_sessions
WHERE
    transactionRevenue IS NOT NULL
GROUP BY
    city,
    country
ORDER BY
    total_transaction_revenue DESC




Answer: 

United States and the city of Sunnyvale


Question 2: What is the average number of products ordered from visitors in each city and country?

SQL Queries:


SELECT
    all_s.city,
    all_s.country,
    AVG(ps.orderedQuantity) AS average_products_ordered
FROM
    products ps
JOIN
    all_sessions all_s
On
    ps.productsku = all_s.productsku
Group by all_s.city,
    all_s.country
ORDER BY
    average_products_ordered DESC


Answer:
[data-1699554476110.csv](https://github.com/TyShuro/Project_SQL/files/13311604/data-1699554476110.csv)

[Uplo"city","country","average_products_ordered"
"Council Bluffs","United States","7589.0000000000000000"
"Mali_city","Mali","3786.0000000000000000"
"Bellflower","United States","3786.0000000000000000"
"Montenegro_city","Montenegro","3786.0000000000000000"
"Cork","Ireland","3786.0000000000000000"
"Santiago","Chile","3607.0000000000000000"
"Bellingham","United States","2836.0000000000000000"
"Detroit","United States","2748.0000000000000000"
"Papua New Guinea_city","Papua New Guinea","2558.0000000000000000"
"Réunion_city","Réunion","2538.0000000000000000"
"Georgia_city","Georgia","2506.4000000000000000"
"Westville","South Africa","2299.0000000000000000"
"Santa Fe","Argentina","1932.5000000000000000"
"Côte d’Ivoire_city","Côte d’Ivoire","1928.5000000000000000"
"Moldova_city","Moldova","1893.0000000000000000"
"Nashville","United States","1886.0000000000000000"
"Brno","Czechia","1548.0000000000000000"
"Zhongli District","Taiwan","1492.0000000000000000"
"Tanzania_city","Tanzania","1429.0000000000000000"
"Trinidad & Tobago_city","Trinidad & Tobago","1379.5000000000000000"
"Ghent","Belgium","1351.0000000000000000"
"Armenia_city","Armenia","1351.0000000000000000"
"Gurgaon","India","1335.8571428571428571"
"Oman_city","Oman","1330.0000000000000000"
"Rome","Italy","1310.4000000000000000"
"Mississauga","Canada","1305.2500000000000000"
"Moscow","Russia","1291.8000000000000000"
"Madrid","Spain","1286.4666666666666667"
"Portugal_city","Portugal","1265.9000000000000000"
"Ethiopia_city","Ethiopia","1239.0000000000000000"
"Bulgaria_city","Bulgaria","1231.7272727272727273"
"Prague","Czechia","1216.5000000000000000"
"Morocco_city","Morocco","1203.4285714285714286"
"Belo Horizonte","Brazil","1184.0000000000000000"
"Sakai","Japan","1148.0000000000000000"
"Riyadh","Saudi Arabia","1138.0000000000000000"
"Saint Petersburg","Russia","1106.7500000000000000"
"San Bruno","United States","1106.4285714285714286"
"Sint Maarten_city","Sint Maarten","1100.0000000000000000"
"Puerto Rico_city","Puerto Rico","1099.8333333333333333"
"San Diego","United States","1093.5238095238095238"
"Milan","Italy","1091.5454545454545455"
"Athens","Greece","1088.4000000000000000"
"Perth","Australia","1035.8000000000000000"
"Minato","Japan","1033.6969696969696970"
"Uganda_city","Uganda","1033.0000000000000000"
"Wrexham","United Kingdom","1033.0000000000000000"
"Sudan_city","Sudan","935.0000000000000000"
"Lebanon_city","Lebanon","935.0000000000000000"
"Los Angeles","Australia","917.0000000000000000"
"Laos_city","Laos","886.6666666666666667"
"Munich","Germany","865.2857142857142857"
"Kirkland","United States","847.7179487179487179"
"Romania_city","Romania","847.1562500000000000"
"Longtan District","Taiwan","845.0000000000000000"
"Dublin","Netherlands","844.0000000000000000"
"Zimbabwe_city","Zimbabwe","844.0000000000000000"
"Dominican Republic_city","Dominican Republic","829.5454545454545455"
"Santa Clara","United States","826.8275862068965517"
"Sao Paulo","Brazil","826.6785714285714286"
"Sherbrooke","Canada","812.6666666666666667"
"Dubai","United Arab Emirates","798.1428571428571429"
"Menlo Park","United States","791.0000000000000000"
"Israel_city","Israel","783.1666666666666667"
"Indianapolis","United States","769.0000000000000000"
"San Marino_city","San Marino","757.0000000000000000"
"Charlotte","United States","749.1333333333333333"
"Tunisia_city","Tunisia","748.0000000000000000"
"Montreuil","France","726.5000000000000000"
"Mexico City","Mexico","723.3750000000000000"
"Algeria_city","Algeria","720.5000000000000000"
"Taiwan_city","Taiwan","715.9805194805194805"
"Berlin","Germany","708.7692307692307692"
"Palo Alto","United States","703.4367816091954023"
"Macau_city","Macau","701.6666666666666667"
"Italy_city","Italy","697.8857142857142857"
"Bucharest","Romania","697.4444444444444444"
"Phoenix","United States","694.8333333333333333"
"Indore","India","689.0000000000000000"
"Honduras_city","Honduras","680.5000000000000000"
"Seoul","South Korea","670.5454545454545455"
"Singapore","Singapore","667.1891891891891892"
"Redmond","United States","661.1250000000000000"
"Melbourne","Australia","659.3750000000000000"
"Dublin","Ireland","657.4000000000000000"
"Chicago","United States","647.2916666666666667"
"Cambridge","United States","627.1250000000000000"
"Kazakhstan_city","Kazakhstan","617.0000000000000000"
"Bangkok","Thailand","610.3461538461538462"
"United Kingdom_city","United Kingdom","606.1243781094527363"
"Czechia_city","Czechia","605.4428571428571429"
"Guatemala_city","Guatemala","603.2222222222222222"
"Hyderabad","India","602.3269230769230769"
"Serbia_city","Serbia","602.2307692307692308"
"Hong Kong_city","Hong Kong","601.6111111111111111"
"Denmark_city","Denmark","598.7037037037037037"
"Kolkata","India","593.2222222222222222"
"Peru_city","Peru","589.5555555555555556"
"Panama_city","Panama","588.6666666666666667"
"Ukraine_city","Ukraine","587.5142857142857143"
"Quebec City","Canada","578.1428571428571429"
"Mountain View","United States","576.6178535606820461"
"Costa Rica_city","Costa Rica","573.4000000000000000"
"Austin","United States","570.6914893617021277"
"Toronto","Canada","570.4678899082568807"
"Edmonton","Canada","569.5000000000000000"
"Hong Kong","Hong Kong","568.8750000000000000"
"Nepal_city","Nepal","568.0000000000000000"
"Shinjuku","Japan","565.2857142857142857"
"Indonesia_city","Indonesia","564.4821428571428571"
"Mexico_city","Mexico","560.1896551724137931"
"Philippines_city","Philippines","559.2727272727272727"
"Slovenia_city","Slovenia","553.8750000000000000"
"Vladivostok","Russia","551.0000000000000000"
"Australia_city","Australia","550.4927536231884058"
"Tel Aviv-Yafo","Israel","547.7567567567567568"
"Myanmar (Burma)_city","Myanmar (Burma)","543.6666666666666667"
"Pozuelo de Alarcon","Spain","541.3333333333333333"
"Pakistan_city","Pakistan","539.7179487179487179"
"Vietnam_city","Vietnam","538.0000000000000000"
"Brazil_city","Brazil","537.0631578947368421"
"Pittsburgh","United States","533.7272727272727273"
"Slovakia_city","Slovakia","525.1428571428571429"
"(not set)_city","(not set)","520.6111111111111111"
"Croatia_city","Croatia","516.5384615384615385"
"The Dalles","United States","516.5000000000000000"
"Lithuania_city","Lithuania","511.3571428571428571"
"Albania_city","Albania","510.3333333333333333"
"Russia_city","Russia","506.9850746268656716"
"United States_city","United States","505.5951859956236324"
"San Francisco","United States","505.0257069408740360"
"Macedonia (FYROM)_city","Macedonia (FYROM)","505.0000000000000000"
"Dallas","United States","503.2758620689655172"
"London","United Kingdom","501.2093023255813953"
"San Francisco","France","499.0000000000000000"
"Bhubaneswar","India","499.0000000000000000"
"Japan_city","Japan","498.0939597315436242"
"Bahamas_city","Bahamas","498.0000000000000000"
"Chennai","India","497.1969696969696970"
"Sunnyvale","United States","491.9389067524115756"
"Canada_city","Canada","490.2767624020887728"
"Bogota","Colombia","488.0000000000000000"
"New Delhi","India","487.6944444444444444"
"Thailand_city","Thailand","486.8500000000000000"
"South Korea_city","South Korea","486.7391304347826087"
"Atlanta","United States","483.0877192982456140"
"Seattle","United States","478.0280373831775701"
"Calgary","Canada","472.2000000000000000"
"Mumbai","India","470.3061224489795918"
"Malta_city","Malta","469.5000000000000000"
"San Jose","United States","468.2216981132075472"
"Cupertino","United States","466.7000000000000000"
"Germany_city","Germany","466.5807692307692308"
"La Victoria","Peru","465.2500000000000000"
"New Zealand_city","New Zealand","464.2272727272727273"
"Warsaw","Poland","463.5217391304347826"
"Bengaluru","India","463.4307692307692308"
"India_city","India","452.5641891891891892"
"Netherlands_city","Netherlands","448.8846153846153846"
"Tempe","United States","447.2500000000000000"
"France_city","France","447.2357142857142857"
"Salem","United States","446.2750000000000000"
"Oakland","United States","445.4285714285714286"
"Hamburg","Germany","437.0909090909090909"
"Redwood City","United States","435.1666666666666667"
"Buenos Aires","Argentina","434.5000000000000000"
"Osaka","Japan","434.3333333333333333"
"Rosario","Argentina","433.0000000000000000"
"Kosovo_city","Kosovo","433.0000000000000000"
"Singapore","France","433.0000000000000000"
"New York","United States","431.9614678899082569"
"Karachi","Pakistan","428.0000000000000000"
"Istanbul","Turkey","420.6818181818181818"
"Spain_city","Spain","417.6818181818181818"
"Malaysia_city","Malaysia","416.8709677419354839"
"Colombia_city","Colombia","411.7931034482758621"
"Switzerland_city","Switzerland","409.1607142857142857"
"Kalamazoo","United States","403.0000000000000000"
"Fremont","United States","401.5000000000000000"
"Los Angeles","United States","401.2222222222222222"
"Kiev","Ukraine","400.5625000000000000"
"Zurich","Switzerland","399.6666666666666667"
"Norway_city","Norway","397.4827586206896552"
"Sydney","Australia","396.0909090909090909"
"Vancouver","Canada","395.0000000000000000"
"Monterrey","Mexico","393.0000000000000000"
"Sri Lanka_city","Sri Lanka","392.1666666666666667"
"Singapore_city","Singapore","391.5254237288135593"
"Amsterdam","Netherlands","390.4000000000000000"
"Latvia_city","Latvia","387.6250000000000000"
"Bosnia & Herzegovina_city","Bosnia & Herzegovina","386.6666666666666667"
"Pune","India","386.5555555555555556"
"Kuala Lumpur","Malaysia","384.5000000000000000"
"Uruguay_city","Uruguay","384.3333333333333333"
"Hungary_city","Hungary","383.4285714285714286"
"Houston","United States","380.2500000000000000"
"Irvine","United States","379.8888888888888889"
"Ho Chi Minh City","Vietnam","378.3333333333333333"
"Greece_city","Greece","377.6000000000000000"
"San Antonio","United States","368.8571428571428571"
"Poland_city","Poland","368.1162790697674419"
"Sweden_city","Sweden","366.7446808510638298"
"Ahmedabad","India","364.6363636363636364"
"Hong Kong","United States","363.0000000000000000"
"Istanbul","Hungary","363.0000000000000000"
"Cambodia_city","Cambodia","362.2000000000000000"
"Ipoh","Malaysia","362.0000000000000000"
"Boulder","United States","361.0000000000000000"
"Venezuela_city","Venezuela","359.0000000000000000"
"Denver","United States","355.8333333333333333"
"Taguig","Philippines","355.4285714285714286"
"Ireland_city","Ireland","354.3793103448275862"
"Paris","France","352.8837209302325581"
"Turkey_city","Turkey","350.2424242424242424"
"Courbevoie","France","348.0000000000000000"
"Jakarta","Indonesia","347.7826086956521739"
"Hanoi","Vietnam","347.0000000000000000"
"Argentina_city","Argentina","344.8333333333333333"
"Timisoara","Romania","344.0000000000000000"
"Jaipur","India","339.5000000000000000"
"Finland_city","Finland","337.3333333333333333"
"Austria_city","Austria","331.5862068965517241"
"Avon","United States","330.5000000000000000"
"Pleasanton","United States","330.0000000000000000"
"Patna","India","327.0000000000000000"
"Jacksonville","United States","326.5000000000000000"
"Egypt_city","Egypt","322.4545454545454545"
"Kitchener","Canada","321.4000000000000000"
"United Arab Emirates_city","United Arab Emirates","316.2000000000000000"
"Philadelphia","United States","315.0000000000000000"
"Montreal","Canada","313.8947368421052632"
"Boston","United States","313.3157894736842105"
"Rexburg","United States","308.6666666666666667"
"Lisbon","Portugal","299.0000000000000000"
"Sacramento","United States","299.0000000000000000"
"Jordan_city","Jordan","295.0000000000000000"
"Montevideo","Uruguay","292.5000000000000000"
"Ann Arbor","United States","290.5609756097560976"
"Nigeria_city","Nigeria","280.1428571428571429"
"Saudi Arabia_city","Saudi Arabia","277.3333333333333333"
"Santa Monica","United States","276.0000000000000000"
"Brisbane","Australia","274.5000000000000000"
"Wellesley","United States","269.0000000000000000"
"Druid Hills","United States","269.0000000000000000"
"Nicaragua_city","Nicaragua","268.0000000000000000"
"Chile_city","Chile","261.8000000000000000"
"Oviedo","United States","260.0000000000000000"
"Bangladesh_city","Bangladesh","242.7419354838709677"
"Barcelona","Spain","241.5294117647058824"
"Belgium_city","Belgium","237.0178571428571429"
"Belarus_city","Belarus","231.0000000000000000"
"Villeneuve-d'Ascq","France","230.0000000000000000"
"China_city","China","229.0000000000000000"
"Vienna","Austria","228.5000000000000000"
"Bahrain_city","Bahrain","226.3333333333333333"
"Kuwait_city","Kuwait","221.1666666666666667"
"Culiacan","Mexico","220.0000000000000000"
"Lahore","Pakistan","218.0000000000000000"
"Lake Oswego","United States","215.0000000000000000"
"Botswana_city","Botswana","215.0000000000000000"
"University Park","United States","215.0000000000000000"
"Stuttgart","Germany","214.0000000000000000"
"Medellin","Colombia","208.0000000000000000"
"South Africa_city","South Africa","203.5909090909090909"
"Burnaby","Canada","200.6666666666666667"
"Ghana_city","Ghana","197.0000000000000000"
"Washington","United States","191.1111111111111111"
"Ashburn","United States","187.5000000000000000"
"Richardson","United States","185.0000000000000000"
"Budapest","Hungary","184.1666666666666667"
"Glasgow","United Kingdom","183.0000000000000000"
"Sandton","South Africa","183.0000000000000000"
"Oxford","United Kingdom","183.0000000000000000"
"Rio de Janeiro","Brazil","179.6666666666666667"
"New York","Canada","178.0000000000000000"
"Stanford","United States","178.0000000000000000"
"Jamaica_city","Jamaica","178.0000000000000000"
"Thessaloniki","Greece","171.5000000000000000"
"Salford","United Kingdom","171.0000000000000000"
"Toronto","United States","168.0000000000000000"
"Goose Creek","United States","168.0000000000000000"
"Tampa","United States","168.0000000000000000"
"Stockholm","Sweden","163.4666666666666667"
"Mexico City","United States","160.0000000000000000"
"South San Francisco","United States","159.5000000000000000"
"Palestine_city","Palestine","155.0000000000000000"
"Columbia","United States","154.0000000000000000"
"Shibuya","Japan","152.0000000000000000"
"Estonia_city","Estonia","151.2000000000000000"
"Mountain View","Japan","151.0000000000000000"
"Iraq_city","Iraq","150.6666666666666667"
"Colombo","Sri Lanka","138.6666666666666667"
"Martinique_city","Martinique","138.5000000000000000"
"Hayward","United States","137.0000000000000000"
"South El Monte","United States","137.0000000000000000"
"Ecuador_city","Ecuador","136.7272727272727273"
"Antwerp","Belgium","134.5000000000000000"
"Manila","Philippines","128.7500000000000000"
"Kyrgyzstan_city","Kyrgyzstan","123.0000000000000000"
"Maracaibo","Venezuela","119.5000000000000000"
"Mauritius_city","Mauritius","104.5000000000000000"
"Norfolk","United States","102.0000000000000000"
"Orlando","United States","100.1666666666666667"
"Madison","United States","92.0000000000000000"
"Yokohama","Japan","91.8333333333333333"
"Bolivia_city","Bolivia","90.0000000000000000"
"Gibraltar_city","Gibraltar","79.0000000000000000"
"Iasi","Romania","79.0000000000000000"
"Cyprus_city","Cyprus","78.2500000000000000"
"Poznan","Poland","73.5000000000000000"
"Minneapolis","United States","70.0000000000000000"
"Quezon City","Philippines","66.8333333333333333"
"Milpitas","United States","66.3750000000000000"
"Appleton","United States","66.0000000000000000"
"East Lansing","United States","66.0000000000000000"
"San Francisco","Japan","65.0000000000000000"
"Chuo","Japan","65.0000000000000000"
"Frankfurt","Germany","65.0000000000000000"
"Doha","Qatar","62.0000000000000000"
"Brussels","Belgium","62.0000000000000000"
"Cluj-Napoca","Romania","62.0000000000000000"
"Copenhagen","Denmark","61.5000000000000000"
"Eau Claire","United States","59.6363636363636364"
"Jersey_city","Jersey","59.0000000000000000"
"Neipu Township","Taiwan","58.0000000000000000"
"Izmir","Turkey","58.0000000000000000"
"Kovrov","Russia","58.0000000000000000"
"Zagreb","Croatia","54.0000000000000000"
"Adelaide","Australia","54.0000000000000000"
"Petaling Jaya","Malaysia","53.5000000000000000"
"Bandung","Indonesia","53.0000000000000000"
"Nanded","India","53.0000000000000000"
"Auckland","New Zealand","52.0000000000000000"
"Makati","Philippines","51.5000000000000000"
"Kharkiv","Ukraine","51.0000000000000000"
"Manchester","United Kingdom","50.5000000000000000"
"Egham","United Kingdom","50.0000000000000000"
"Somalia_city","Somalia","50.0000000000000000"
"San Salvador","El Salvador","49.0000000000000000"
"Kharagpur","India","46.0000000000000000"
"Brunei_city","Brunei","45.5000000000000000"
"Piscataway Township","United States","40.0000000000000000"
"Vilnius","Lithuania","40.0000000000000000"
"Oslo","Norway","40.0000000000000000"
"San Mateo","United States","36.0000000000000000"
"St. John's","Canada","34.0000000000000000"
"Lucknow","India","33.0000000000000000"
"Maldives_city","Maldives","33.0000000000000000"
"Mountain View","Australia","33.0000000000000000"
"Qatar_city","Qatar","31.0000000000000000"
"Marseille","France","31.0000000000000000"
"Helsinki","Finland","31.0000000000000000"
"Kenya_city","Kenya","27.0000000000000000"
"Las Vegas","United States","26.6666666666666667"
"Greer","United States","26.0000000000000000"
"Ottawa","Canada","25.5000000000000000"
"Cape Town","South Africa","25.0000000000000000"
"Berkeley","United States","25.0000000000000000"
"Yokohama","United States","25.0000000000000000"
"Barbados_city","Barbados","25.0000000000000000"
"Chico","United States","22.0000000000000000"
"Fortaleza","Brazil","22.0000000000000000"
"Nagoya","Japan","22.0000000000000000"
"Coventry","United Kingdom","22.0000000000000000"
"Jersey City","United States","18.3333333333333333"
"Parsippany-Troy Hills","United States","18.0000000000000000"
"Beijing","China","16.0000000000000000"
"Portland","United States","15.0000000000000000"
"Chandigarh","India","15.0000000000000000"
"Akron","United States","15.0000000000000000"
"LaFayette","United States","15.0000000000000000"
"Asuncion","Paraguay","15.0000000000000000"
"El Salvador_city","El Salvador","14.0000000000000000"
"Bilbao","Spain","13.5000000000000000"
"St. Louis","United States","13.5000000000000000"
"Sapporo","Japan","12.0000000000000000"
"Luxembourg_city","Luxembourg","12.0000000000000000"
"London","United States","10.6666666666666667"
"Columbus","United States","8.5000000000000000"
"Amsterdam","United States","8.0000000000000000"
"Waterloo","Canada","8.0000000000000000"
"Bangkok","United States","7.0000000000000000"
"Nairobi","Kenya","6.0000000000000000"
"Paris","United States","6.0000000000000000"
"Forest Park","United States","5.0000000000000000"
"Kansas City","United States","4.0000000000000000"
"El Paso","United States","2.0000000000000000"
"Haiti_city","Haiti","1.00000000000000000000"
"Rwanda_city","Rwanda","0.00000000000000000000"
"Iceland_city","Iceland","0.00000000000000000000"
"Bordeaux","France","0.00000000000000000000"
"Marlboro","United States","0.00000000000000000000"
"Fort Worth","United States","0.00000000000000000000"
"Chiyoda","Japan","0.00000000000000000000"
"Antalya","Turkey","0.00000000000000000000"
"Bratislava","Slovakia","0.00000000000000000000"
"Watford","United Kingdom","0.00000000000000000000"
"Panama City","United States","0.00000000000000000000"
"Rotterdam","Netherlands","0.00000000000000000000"
"Vancouver","United States","0.00000000000000000000"
"Westlake Village","United States","0.00000000000000000000"
ading data-1699554476110.csv…]()


Question 3: 

SQL Queries:

Answer:



Question 4: 

SQL Queries:

Answer:



Question 5: 

SQL Queries:

Answer:
